<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Recommender</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#searchForm').submit(function(event) {
                event.preventDefault(); // Prevent the default form submission
                var movieName = $('#search_input').val();

                $.ajax({
                    url: "{{ url_for('similarity') }}",
                    type: "POST",
                    data: { 'name': movieName },
                    success: function(response) {
                        $('.popular_container').empty(); // Clear previous results
                        if (typeof response === 'string' && response.startsWith("Sorry!")) {
                            $('.popular_container').append('<p>' + response + '</p>');
                        } else if (typeof response === 'object' && response.recommendations) {
                            var recommendations = response.recommendations;
                            if (recommendations.length > 0) {
                                var recommendationsHTML = '<h3>Recommendations:</h3><ul>';
                                for (var i = 0; i < recommendations.length; i++) {
                                    recommendationsHTML += '<li>' + recommendations[i] + '</li>';
                                }
                                recommendationsHTML += '</ul>';
                                $('.popular_container').append(recommendationsHTML);
                            } else {
                                $('.popular_container').append('<p>No recommendations found.</p>');
                            }
                        } else {
                            $('.popular_container').append('<p>Error fetching recommendations.</p>');
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error("Error fetching recommendations:", error);
                        $('.popular_container').append('<p>Error fetching recommendations.</p>');
                    }
                });
            });
        });
    </script>
</head>
<body>
    <header>
        <div class="logo">
            <img class="netflix_logo" src="{{ url_for('static', filename='Netflix.png') }}" alt="Netflix Logo">
            <a class="logo_link" href="{{ url_for('home') }}">Netflix Recommender</a>
        </div>
    </header>
    <div class="hero">
        <div class="search_box">
            <form method="POST" action="{{ url_for('similarity') }}" id="searchForm">
                <input type="text" class="search_input" name="name" id="search_input" placeholder="Enter movie name" required="required"><br>
                <input type="submit" class="search_button" value ="Search">
            </form>
        </div>

        <div class="sugg">
            </div>

        <div class="popular_container">
            </div>
    </div>
</body>
</html>
